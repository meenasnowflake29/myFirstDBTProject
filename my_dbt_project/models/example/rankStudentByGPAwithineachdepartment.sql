SELECT Student_ID, Full_Name, Department, GPA,
  RANK() OVER (PARTITION BY Department ORDER BY GPA DESC) AS GPA_Rank
FROM LOGAN_DATA.DESTINATIONMEENASTDDATA.STUDATA
